# topology configuration
config:
  topology.parallelism: {{ getv "/kilda_storm_parallelism_level_new" }}
  topology.workers: {{ getv "/kilda_storm_parallelism_workers_count" }}
  topology.spouts.parallelism: {{ getv "/kilda_storm_parallelism_level" }}

{{- if exists "/kilda_storm_disruptor_wait_timeout" }}
  # Configure timeout milliseconds used for disruptor queue wait strategy. Can be used to tradeoff latency vs. CPU usage.
  topology.disruptor.wait.timeout.millis : {{ getv "/kilda_storm_disruptor_wait_timeout" }}
{{- end }}
{{- if exists "/kilda_storm_disruptor_batch_timeout" }}
  # The maximum age in milliseconds a batch can be before being sent to the next thread.
  topology.disruptor.batch.timeout.millis : {{ getv "/kilda_storm_disruptor_batch_timeout" }}
{{- end }}
{{- if exists "/kilda_storm_spout_wait_sleep_timeout" }}
  topology.spout.wait.strategy : org.apache.storm.spout.SleepSpoutWaitStrategy
  # The amount of milliseconds a spout should sleep when emits no tuples.
  topology.sleep.spout.wait.strategy.time.ms : {{ getv "/kilda_storm_spout_wait_sleep_timeout" }}
{{- end }}

# spout definitions
# spouts:

# bolt definitions
bolts:
  - id: "KILDA_TOPO_DISCO_BOLT"
    # must be 1 for now
    parallelism: 1
  - id: "clock"
    parallelism: 1
